(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50436,       1209]
NotebookOptionsPosition[     47988,       1167]
NotebookOutlinePosition[     48330,       1182]
CellTagsIndexPosition[     48287,       1179]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "4"}], ";", " ", 
  RowBox[{"NN", "=", 
   SuperscriptBox["2", "L"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", "1"},
         {"1", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"0", 
          RowBox[{"-", "\[ImaginaryI]"}]},
         {"\[ImaginaryI]", "0"}
        }], "\[NoBreak]", ")"}], ",", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], "\[NoBreak]", ")"}]}], "}"}]}], ";", " ", 
   RowBox[{"Id", "=", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "0"},
       {"0", "1"}
      }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Matrix", " ", "implementation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ssm", "[", 
    RowBox[{"a_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]a", ",", "i\[Psi]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Sigma]a", "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i\[Psi]", "=", "L"}], ",", 
        RowBox[{"i\[Psi]", ">", "i"}], ",", 
        RowBox[{"i\[Psi]", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Sigma]a", "=", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"\[Sigma]a", ",", "Id"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Sigma]a", "=", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{"\[Sigma]a", ",", 
         RowBox[{"\[Sigma]s", "[", 
          RowBox[{"[", "a", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i\[Psi]", "=", 
         RowBox[{"i", "-", "1"}]}], ",", 
        RowBox[{"i\[Psi]", "\[GreaterEqual]", "1"}], ",", 
        RowBox[{"i\[Psi]", "--"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Sigma]a", "=", 
          RowBox[{"KroneckerProduct", "[", 
           RowBox[{"\[Sigma]a", ",", "Id"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[Sigma]a"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Import", "[", "\"\<G:\\\\LAT\\\\ExDiag\\\\hi.dat\>\"", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "h", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sssm", "=", 
   RowBox[{"Sum", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"in", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "<", "L"}], ",", 
         RowBox[{"i", "+", "1"}], ",", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"ssm", "[", 
            RowBox[{"1", ",", "i"}], "]"}], ".", 
           RowBox[{"ssm", "[", 
            RowBox[{"1", ",", "in"}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ssm", "[", 
            RowBox[{"2", ",", "i"}], "]"}], ".", 
           RowBox[{"ssm", "[", 
            RowBox[{"2", ",", "in"}], "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ssm", "[", 
            RowBox[{"3", ",", "i"}], "]"}], ".", 
           RowBox[{"ssm", "[", 
            RowBox[{"3", ",", "in"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"h", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", 
        RowBox[{"ssm", "[", 
         RowBox[{"3", ",", "i"}], "]"}]}]}]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sssc", "=", 
   RowBox[{"Import", "[", "\"\<G:\\\\LAT\\\\ExDiag\\\\H.dat\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<|M1 - M2| = \>\"", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{"sssm", "-", "sssc"}], ",", "\"\<Frobenius\>\""}], "]"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"evm", ",", "evs"}], "}"}], "=", 
   RowBox[{"Eigensystem", "[", "sssm", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evc", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Import", "[", "\"\<G:\\\\LAT\\\\ExDiag\\\\E.dat\>\"", "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", "evc", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Checking", " ", "the", " ", "spin"}], "-", 
    RowBox[{"0", " ", "sector"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evs0", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ie", "=", "1"}], ",", 
    RowBox[{"ie", "\[LessEqual]", "NN"}], ",", 
    RowBox[{"ie", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "=", 
      RowBox[{
       RowBox[{"sssm", ".", 
        RowBox[{"evs", "[", 
         RowBox[{"[", "ie", "]"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"evm", "[", 
         RowBox[{"[", "ie", "]"}], "]"}], " ", 
        RowBox[{"evs", "[", 
         RowBox[{"[", "ie", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SZ", "=", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"evs", "[", 
          RowBox[{"[", "ie", "]"}], "]"}], ".", 
         RowBox[{"ssm", "[", 
          RowBox[{"3", ",", "i"}], "]"}], ".", 
         RowBox[{"evs", "[", 
          RowBox[{"[", "ie", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Abs", "[", "SZ", "]"}], "<", 
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]]}], ",", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"evs0", ",", 
          RowBox[{"evm", "[", 
           RowBox[{"[", "ie", "]"}], "]"}]}], " ", "]"}], ";"}]}], "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Sort", "[", "evs0", "]"}], ",", "\"\< \>\"", ",", 
    RowBox[{"Sort", "[", "evc", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Eigenvalue error: \>\"", ",", 
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{"Sort", "[", "evs0", "]"}], "-", 
      RowBox[{"Sort", "[", "evc", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.807084219756776*^9, 3.807084273943093*^9}, {
   3.8070843811775093`*^9, 3.807084412273031*^9}, {3.8070844434339523`*^9, 
   3.8070845837860107`*^9}, {3.807084644771757*^9, 3.8070846448904333`*^9}, {
   3.8070846876732645`*^9, 3.8070847723660507`*^9}, {3.807084835078782*^9, 
   3.807085042990562*^9}, {3.8070850785575*^9, 3.8070852778551216`*^9}, {
   3.807085453277116*^9, 3.8070855513940325`*^9}, {3.807085587272088*^9, 
   3.8070856771776896`*^9}, {3.8070857118532686`*^9, 
   3.8070857943425627`*^9}, {3.8070858682342587`*^9, 3.807085889552812*^9}, {
   3.807085964268621*^9, 3.8070862012925167`*^9}, {3.807086232131857*^9, 
   3.8070863897971244`*^9}, {3.8070864213390493`*^9, 3.807086541632346*^9}, {
   3.8070865741088285`*^9, 3.8070867403014865`*^9}, {3.80708681140149*^9, 
   3.807086827264389*^9}, {3.8070873012419996`*^9, 3.807087309663401*^9}, {
   3.807087412723892*^9, 3.807087471147807*^9}, {3.807087517652229*^9, 
   3.8070875215597167`*^9}, {3.807087630039439*^9, 3.807087724262426*^9}, {
   3.807087780541209*^9, 3.8070877818702917`*^9}, {3.8070878484534945`*^9, 
   3.8070879619618063`*^9}, {3.8070879921769886`*^9, 
   3.8070880403755007`*^9}, {3.807088137869276*^9, 3.807088232542619*^9}, {
   3.8070882687375374`*^9, 3.8070884113524694`*^9}, {3.8070884467437353`*^9, 
   3.80708847331623*^9}, {3.8070885708035297`*^9, 3.8070885813039684`*^9}, {
   3.807088621337904*^9, 3.8070887054734116`*^9}, {3.8070887759310117`*^9, 
   3.8070887984541206`*^9}, {3.807088899024125*^9, 3.8070889279053707`*^9}, {
   3.807088963574626*^9, 3.8070889637581425`*^9}, {3.8070890623233614`*^9, 
   3.807089062431127*^9}, {3.807099467656169*^9, 3.8070994676980824`*^9}, {
   3.807099526539214*^9, 3.807099779909013*^9}, {3.807100085192396*^9, 
   3.807100250614227*^9}, {3.8071002953395166`*^9, 3.8071003150383816`*^9}, {
   3.8071005131138325`*^9, 3.8071005175332236`*^9}, {3.807100577169208*^9, 
   3.80710058310254*^9}, {3.807100631950623*^9, 3.8071007315358553`*^9}, 
   3.807100859523324*^9, {3.807100995028655*^9, 3.8071010296829576`*^9}, 
   3.80710107316068*^9, {3.8071014317809258`*^9, 3.8071014473266907`*^9}, {
   3.8071015033849707`*^9, 3.8071016083866825`*^9}, {3.8071017382415113`*^9, 
   3.8071017759275403`*^9}, {3.807101980395287*^9, 3.8071020240471354`*^9}, {
   3.8071020775196533`*^9, 3.8071021260413756`*^9}, {3.807103356851083*^9, 
   3.8071034095488873`*^9}, {3.807103441721735*^9, 3.8071034925727167`*^9}, {
   3.8071037134044647`*^9, 3.807103713469299*^9}, {3.807103744461478*^9, 
   3.80710374451936*^9}, {3.807103904942038*^9, 3.8071040596116714`*^9}, {
   3.807104094470441*^9, 3.807104343801753*^9}, {3.8071044071624713`*^9, 
   3.807104463551772*^9}, {3.8071045192765303`*^9, 3.807104536979183*^9}, {
   3.8071045818385506`*^9, 3.8071046495182433`*^9}, {3.807104749482409*^9, 
   3.8071047851039295`*^9}, {3.8071049358099337`*^9, 3.807104936022373*^9}, {
   3.8071049819164495`*^9, 3.80710504401686*^9}, {3.8071052374282875`*^9, 
   3.8071052864937363`*^9}, {3.8072715082627506`*^9, 3.807271593635104*^9}, {
   3.8072717131107407`*^9, 3.807271724789158*^9}, {3.807271860131198*^9, 
   3.8072719365031557`*^9}, {3.807271979187069*^9, 3.807272006040551*^9}, {
   3.8072721688947115`*^9, 3.8072722005439844`*^9}, {3.8072742076190553`*^9, 
   3.8072742114892178`*^9}, {3.807274515719368*^9, 3.807274524507382*^9}, {
   3.8072746523985014`*^9, 3.807274655424102*^9}, {3.8072747632416315`*^9, 
   3.8072747635829167`*^9}, {3.807274799487418*^9, 3.807274800993723*^9}, {
   3.8072749109460077`*^9, 3.8072750107960997`*^9}, {3.8072793225021524`*^9, 
   3.8072793578361816`*^9}, {3.807279653919676*^9, 3.807279656828643*^9}, {
   3.8072829160790453`*^9, 3.8072830569553714`*^9}, 3.8072831239340587`*^9, {
   3.8072832012327433`*^9, 3.8072832571761866`*^9}, {3.8072834406035595`*^9, 
   3.807283468872932*^9}, {3.8072835575270743`*^9, 3.8072836263443274`*^9}, {
   3.807283711746576*^9, 3.8072837913572693`*^9}, {3.8072838237123833`*^9, 
   3.807283850269786*^9}, {3.8073439779896417`*^9, 3.8073440692703485`*^9}, {
   3.8073443260733366`*^9, 3.807344373305299*^9}, {3.8073444254175873`*^9, 
   3.8073444257869596`*^9}, {3.815120272303727*^9, 
   3.8151202725091867`*^9}},ExpressionUUID->"67dfbb6b-a549-4a8a-ba26-\
b61403bff995"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Algorithmic", " ", "implementations", " ", "to", " ", "test"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ss", "[", 
      RowBox[{"\[Psi]_", ",", "a_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "bmi", ",", "i\[Psi]1", ",", "i\[Psi]2", ",", "f1", ",", "f2"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Bit", " ", "mask", " ", "with", " ", "1", " ", "at", " ", "position",
          " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"bmi", "=", 
         SuperscriptBox["2", 
          RowBox[{"i", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f1", "=", "1"}], ";", " ", 
        RowBox[{"f2", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "2"}], ",", 
          RowBox[{
           RowBox[{"f1", "=", "\[ImaginaryI]"}], ";", " ", 
           RowBox[{"f2", "=", 
            RowBox[{"-", "\[ImaginaryI]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "3"}], ",", 
          RowBox[{"f1", "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"i\[Psi]2", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "\[Equal]", "3"}], ",", "i\[Psi]1", ",", 
              RowBox[{"BitXor", "[", 
               RowBox[{"bmi", ",", "i\[Psi]1"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"BitAnd", "[", 
                RowBox[{"i\[Psi]1", ",", "bmi"}], "]"}], "\[NotEqual]", "0"}],
               ",", "f1", ",", "f2"}], "]"}], " ", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"[", 
              RowBox[{"i\[Psi]2", "+", "1"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"i\[Psi]1", ",", "0", ",", 
            RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ss1ss2", "[", 
      RowBox[{"\[Psi]_", ",", "a_", ",", "i_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "in", ",", "bmi1", ",", "bmi2", ",", "i\[Psi]1", ",", "i\[Psi]2", ",",
          "f1", ",", "f2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"in", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "<", "L"}], ",", 
           RowBox[{"i", "+", "1"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bmi1", "=", 
         SuperscriptBox["2", 
          RowBox[{"i", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bmi2", "=", 
         SuperscriptBox["2", 
          RowBox[{"in", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"f1", "=", "1"}], ";", 
        RowBox[{"f2", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "3"}], ",", 
          RowBox[{"f1", "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"a", "\[Equal]", "2"}], ",", 
          RowBox[{"f2", "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"i\[Psi]2", "=", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"a", "\[Equal]", "3"}], ",", "i\[Psi]1", ",", 
              RowBox[{"BitXor", "[", 
               RowBox[{"bmi2", ",", 
                RowBox[{"BitXor", "[", 
                 RowBox[{"bmi1", ",", "i\[Psi]1"}], "]"}]}], "]"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Xor", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i\[Psi]1", ",", "bmi1"}], "]"}], "\[NotEqual]", 
                  "0"}], ")"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i\[Psi]1", ",", "bmi2"}], "]"}], "\[NotEqual]", 
                  "0"}], ")"}]}], "]"}], ",", "f1", ",", "f2"}], "]"}], " ", 
            RowBox[{"\[Psi]", "[", 
             RowBox[{"[", 
              RowBox[{"i\[Psi]2", "+", "1"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i\[Psi]1", ",", "0", ",", 
            RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sss", "[", "\[Psi]_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "i", ",", "in", ",", "bmi1", ",", "bmi2", ",", "i\[Psi]1", ",", 
         "i\[Psi]2", ",", "f1", ",", "f2", ",", "f3", ",", "C1"}], "}"}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"Sum", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"in", "=", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "L"}], ",", 
             RowBox[{"i", "+", "1"}], ",", "1"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"bmi1", "=", 
           SuperscriptBox["2", 
            RowBox[{"i", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
          RowBox[{"bmi2", "=", 
           SuperscriptBox["2", 
            RowBox[{"in", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"C1", "=", 
              RowBox[{"Xor", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i\[Psi]1", ",", "bmi1"}], "]"}], "\[NotEqual]", 
                  "0"}], ")"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"BitAnd", "[", 
                   RowBox[{"i\[Psi]1", ",", "bmi2"}], "]"}], "\[NotEqual]", 
                  "0"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"i\[Psi]2", "=", 
              RowBox[{"BitXor", "[", 
               RowBox[{"bmi2", ",", 
                RowBox[{"BitXor", "[", 
                 RowBox[{"bmi1", ",", "i\[Psi]1"}], "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"C1", ",", 
                RowBox[{"2", 
                 RowBox[{"\[Psi]", "[", 
                  RowBox[{"[", 
                   RowBox[{"i\[Psi]2", "+", "1"}], "]"}], "]"}]}], ",", "0"}],
                "]"}], "+", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{"C1", ",", 
                 RowBox[{"-", "1"}], ",", "1"}], "]"}], " ", 
               RowBox[{"\[Psi]", "[", 
                RowBox[{"[", 
                 RowBox[{"i\[Psi]1", "+", "1"}], "]"}], "]"}]}]}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"i\[Psi]1", ",", "0", ",", 
              RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Matrix", " ", "implementations"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Psi]", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"SS", "=", 
         RowBox[{"IntegerString", "[", 
          RowBox[{"i\[Psi]", ",", "2", ",", "L"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<\[Psi]\>\"", "<>", "SS"}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i\[Psi]", ",", "0", ",", 
         RowBox[{"NN", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"MaxErr", "=", "0.0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"itrial", "=", "1"}], ",", 
       RowBox[{"itrial", "\[LessEqual]", "100"}], ",", 
       RowBox[{"itrial", "++"}], ","}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R1", "=", 
     RowBox[{"sssm", ".", "\[Psi]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"MatrixForm", "[", "sssm", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R2", "=", 
     RowBox[{"sss", "[", "\[Psi]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Err = \>\"", ",", 
      RowBox[{"Norm", "[", 
       RowBox[{"R1", "-", "R2"}], "]"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"MaxErr", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"MaxErr", ",", 
          RowBox[{"Norm", "[", 
           RowBox[{"R1", "-", "R2"}], "]"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "MaxErr", "]"}], ";"}], "*)"}]}]}]], "Input",Expres\
sionUUID->"32a43ea2-f327-492a-b3e3-aaa9b785e304"],

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "n"}], ",", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"2", "n"}], ")"}], "!"}], 
       RowBox[{
        RowBox[{"n", "!"}], " ", 
        RowBox[{"n", "!"}]}]], ",", 
      SuperscriptBox["2", 
       RowBox[{"2", "n"}]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", "16"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8072822548784785`*^9, 3.807282308685505*^9}, 
   3.8072827012723365`*^9},
 CellLabel->
  "In[316]:=",ExpressionUUID->"b19fc981-07e8-4b87-a96c-0ea97abca163"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NN", "=", 
   SuperscriptBox["2", "L"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S0basis", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ips", "=", "0"}], ",", " ", 
    RowBox[{"ips", "<", "NN"}], ",", " ", 
    RowBox[{"ips", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"bts", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"ips", ",", "2", ",", "L"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{"bts", ",", "0"}], "]"}], "\[Equal]", 
        RowBox[{"L", "/", "2"}]}], ",", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"S0basis", ",", "ips"}], "]"}], ";"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"IntegerString", "[", 
    RowBox[{"S0basis", ",", "2", ",", "L"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NS0", "=", 
    RowBox[{"Length", "[", "S0basis", "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Implement", " ", "the", " ", "shift", " ", "operator"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ShOp", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"NS0", ",", "NS0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"is1", "=", "1"}], ",", 
    RowBox[{"is1", "\[LessEqual]", "NS0"}], ",", 
    RowBox[{"is1", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ips1", "=", 
      RowBox[{"S0basis", "[", 
       RowBox[{"[", "is1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bts1", "=", 
      RowBox[{"IntegerDigits", "[", 
       RowBox[{"ips1", ",", "2", ",", "L"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bts2", "=", 
      RowBox[{"RotateLeft", "[", 
       RowBox[{"bts1", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ips2", "=", 
      RowBox[{"FromDigits", "[", 
       RowBox[{"bts2", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"is2", "=", 
      RowBox[{
       RowBox[{"Position", "[", 
        RowBox[{"S0basis", ",", "ips2"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"IntegerString", "[", 
        RowBox[{"ips1", ",", "2", ",", "L"}], "]"}], ",", "\"\< (\>\"", ",", 
       "is1", ",", "\"\<) -> \>\"", ",", 
       RowBox[{"IntegerString", "[", 
        RowBox[{"ips2", ",", "2", ",", "L"}], "]"}], ",", "\"\< (\>\"", ",", 
       "is2", ",", "\"\<)\>\""}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ShOp", "[", 
       RowBox[{"[", 
        RowBox[{"is1", ",", "is2"}], "]"}], "]"}], "=", "1"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"MatrixForm", "[", "ShOp", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"evals", ",", " ", "evecs"}], "}"}], "=", 
    RowBox[{"N", "[", 
     RowBox[{"Eigensystem", "[", "ShOp", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Checking", " ", "the", " ", "eigensystem"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"ie", "=", "1"}], ",", 
    RowBox[{"ie", "\[LessEqual]", "NS0"}], ",", 
    RowBox[{"ie", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"evals", "[", 
         RowBox[{"[", "ie", "]"}], "]"}], "]"}], ",", "\"\<: \>\"", ",", 
       RowBox[{"Chop", "[", 
        RowBox[{"evecs", "[", 
         RowBox[{"[", "ie", "]"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"R", ",", " ", 
        RowBox[{"Norm", "[", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ShOp", ".", 
            RowBox[{"evecs", "[", 
             RowBox[{"[", "ie", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"evals", "[", 
             RowBox[{"[", "ie", "]"}], "]"}], " ", 
            RowBox[{"evecs", "[", 
             RowBox[{"[", "ie", "]"}], "]"}]}]}], ")"}], " ", "]"}]}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Max. eigensystem error: \>\"", ",", "R"}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.807282334413826*^9, 3.8072823966059237`*^9}, {
  3.807282563343299*^9, 3.8072826855748744`*^9}, {3.815120504705784*^9, 
  3.815120525765236*^9}, {3.815120573516224*^9, 3.8151206182127695`*^9}, {
  3.8151206565383687`*^9, 3.815120663939065*^9}, {3.815120998042894*^9, 
  3.815121174064822*^9}, {3.8151212395089674`*^9, 3.815121255890309*^9}, {
  3.815122307889177*^9, 3.815122385981216*^9}, {3.8151224193207407`*^9, 
  3.8151225762885246`*^9}, {3.81512261148917*^9, 3.8151227304354486`*^9}, {
  3.815122770573188*^9, 3.8151228116714582`*^9}, {3.815123131348486*^9, 
  3.815123267851077*^9}, {3.81512337897805*^9, 3.8151235169614525`*^9}, {
  3.815211412537697*^9, 3.8152114236540813`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"5b74f9f5-ec7e-4101-ae75-174d0a26be06"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"0011\"\>", ",", "\<\"0101\"\>", ",", "\<\"0110\"\>", 
   ",", "\<\"1001\"\>", ",", "\<\"1010\"\>", ",", "\<\"1100\"\>"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248095827`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"5d6aa923-4d09-4929-90df-00078e950c41"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"0011\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"0110\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["0011", " (", 1, ") -> ", "0110", " (", 3, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424814546*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"5e47de36-6dfd-4136-a35c-ff0b9ec21793"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"0101\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"1010\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "5", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["0101", " (", 2, ") -> ", "1010", " (", 5, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424824521*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"afa0b017-8f3e-4596-b25d-7fbb31e4ddf2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"0110\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "3", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"1100\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "6", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["0110", " (", 3, ") -> ", "1100", " (", 6, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248285203`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"0fb489ae-c639-4532-96f2-d95f67fdea60"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"1001\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "4", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"0011\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "1", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["1001", " (", 4, ") -> ", "0011", " (", 1, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248305283`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"7aa59ebc-9284-4140-940b-b42b99cfa6a4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"1010\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "5", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"0101\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "2", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["1010", " (", 5, ") -> ", "0101", " (", 2, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248335047`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"7f11e9b3-db09-48f3-b31f-ccd71f1419c7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"1100\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "6", "\[InvisibleSpace]", "\<\") -> \"\>", 
   "\[InvisibleSpace]", "\<\"1001\"\>", "\[InvisibleSpace]", "\<\" (\"\>", 
   "\[InvisibleSpace]", "4", "\[InvisibleSpace]", "\<\")\"\>"}],
  SequenceForm["1100", " (", 6, ") -> ", "1001", " (", 4, ")"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248374953`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"ebb7df14-0544-4a38-99ac-cce8fe7a0b66"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0", "0", "0"},
     {"0", "0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "0", "1"},
     {"1", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0"},
     {"0", "0", "0", "1", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424841483*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"e027bd01-af85-4cc1-a1b4-1905ad332340"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", "1.`"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0", ",", 
     RowBox[{"-", "1.`"}], ",", 
     RowBox[{"-", "1.`"}], ",", "0", ",", "1.`"}], "}"}]}],
  SequenceForm[-1., ": ", {1., 0, -1., -1., 0, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.8152114248454723`*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"13c012f0-50a0-4193-a05e-0dea7216a953"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", "1.`"}], "\[InvisibleSpace]", "\<\": \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1.`"}], ",", "0", ",", "0", ",", "1.`", ",", "0"}], "}"}]}],
  SequenceForm[-1., ": ", {0, -1., 0, 0, 1., 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424850424*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"13c99376-66d3-4679-962d-e2972272e9a3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0.`", "\[VeryThinSpace]", "+", 
   RowBox[{
    RowBox[{"1.`", " ", "\[ImaginaryI]"}], "\[InvisibleSpace]", "\<\": \"\>", 
    "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.`"}], ",", "0", ",", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ",", "0", ",", "1.`"}], 
     "}"}]}]}],
  SequenceForm[
   Complex[0., 1.], ": ", {-1., 0, 
    Complex[0., -1.], 
    Complex[0., 1.], 0, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424856408*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"9566893a-db3e-4855-bccf-306a249980df"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"0.`", "\[VeryThinSpace]", "-", 
   RowBox[{
    RowBox[{"1.`", " ", "\[ImaginaryI]"}], "\[InvisibleSpace]", "\<\": \"\>", 
    "\[InvisibleSpace]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.`"}], ",", "0", ",", 
      RowBox[{"0.`", "\[VeryThinSpace]", "+", 
       RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"1.`", " ", "\[ImaginaryI]"}]}], ",", "0", ",", "1.`"}], 
     "}"}]}]}],
  SequenceForm[
   Complex[0., -1.], ": ", {-1., 0, 
    Complex[0., 1.], 
    Complex[0., -1.], 0, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424860433*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"2d091c24-2015-4145-a64d-8d65a1659fa7"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.`", "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1.`", ",", "0", ",", "1.`", ",", "1.`", ",", "0", ",", "1.`"}], 
    "}"}]}],
  SequenceForm[1., ": ", {1., 0, 1., 1., 0, 1.}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.81521142486244*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"b4cfbbe6-22a6-47a2-859a-367b92efe7ff"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1.`", "\[InvisibleSpace]", "\<\": \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1.`", ",", "0", ",", "0", ",", "1.`", ",", "0"}], 
    "}"}]}],
  SequenceForm[1., ": ", {0, 1., 0, 0, 1., 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424865426*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"bc213d75-f789-496d-aad3-9629768b6d23"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Max. eigensystem error: \"\>", "\[InvisibleSpace]", "0.`"}],
  SequenceForm["Max. eigensystem error: ", 0.],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8151206223105593`*^9, {3.8151206573073893`*^9, 3.8151206643300505`*^9}, 
   3.815121051830838*^9, {3.8151211269610176`*^9, 3.8151211562040567`*^9}, 
   3.8151224778299375`*^9, 3.815122517587799*^9, {3.8151225682571554`*^9, 
   3.815122578588756*^9}, 3.8151226239593697`*^9, {3.8151227019574585`*^9, 
   3.815122812308684*^9}, {3.8151232338546915`*^9, 3.8151232694096937`*^9}, {
   3.815123421211464*^9, 3.815123438906786*^9}, {3.8151234829842815`*^9, 
   3.815123518484357*^9}, 3.8152106155962343`*^9, 3.815211424869374*^9},
 CellLabel->
  "During evaluation of \
In[262]:=",ExpressionUUID->"ea027673-f562-4629-96d2-2b5ca58d9670"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Constructing", " ", "the", " ", "momentum", " ", "eigenbasis", " ", "in",
      " ", "the", " ", "spin"}], "-", 
    RowBox[{"0", " ", "sector"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Eigenbasis", " ", "of", " ", "spin"}], "-", 
    RowBox[{"0", " ", "states"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"L", "=", "4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NN", "=", 
     SuperscriptBox["2", "L"]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"S0basis", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"ips", "=", "0"}], ",", " ", 
      RowBox[{"ips", "<", "NN"}], ",", " ", 
      RowBox[{"ips", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"bts", "=", 
        RowBox[{"IntegerDigits", "[", 
         RowBox[{"ips", ",", "2", ",", "L"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"bts", ",", "0"}], "]"}], "\[Equal]", 
          RowBox[{"L", "/", "2"}]}], ",", 
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"S0basis", ",", "ips"}], "]"}], ";"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"S0basis", ",", "2", ",", "L"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"NS0", "=", 
     RowBox[{"Length", "[", "S0basis", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"is", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"is", "\[LessEqual]", "NS0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"S0basis", "[", 
           RowBox[{"[", "is", "]"}], "]"}], "<", "0"}], ",", 
         RowBox[{"is", "++"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<First state which is not used :\>\"", ",", 
         RowBox[{"IntegerString", "[", 
          RowBox[{
           RowBox[{"S0basis", "[", 
            RowBox[{"[", "is", "]"}], "]"}], ",", "2", ",", "L"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.815218672975794*^9, 3.8152187067406807`*^9}, {
  3.815219124577998*^9, 3.8152193195179653`*^9}},
 CellLabel->
  "In[291]:=",ExpressionUUID->"823577f2-2713-4ab7-8b47-46dd0d8bdb82"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"0011\"\>", ",", "\<\"0101\"\>", ",", "\<\"0110\"\>", 
   ",", "\<\"1001\"\>", ",", "\<\"1010\"\>", ",", "\<\"1100\"\>"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.815219140702153*^9, {3.815219299907485*^9, 3.815219321783537*^9}},
 CellLabel->
  "During evaluation of \
In[291]:=",ExpressionUUID->"54f1e3bf-d2cd-4842-9dc6-ccd5ba5c0496"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"First state which is not used :\"\>", 
   "\[InvisibleSpace]", "\<\"0011\"\>"}],
  SequenceForm["First state which is not used :", "0011"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.815219140702153*^9, {3.815219299907485*^9, 3.8152193217925644`*^9}},
 CellLabel->
  "During evaluation of \
In[291]:=",ExpressionUUID->"3d4ac697-8804-4e40-a360-742f78a4c0f4"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 637},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11340, 263, 744, "Input",ExpressionUUID->"67dfbb6b-a549-4a8a-ba26-b61403bff995"],
Cell[11901, 285, 9993, 258, 1001, "Input",ExpressionUUID->"32a43ea2-f327-492a-b3e3-aaa9b785e304"],
Cell[21897, 545, 672, 21, 47, "Input",ExpressionUUID->"b19fc981-07e8-4b87-a96c-0ea97abca163"],
Cell[CellGroupData[{
Cell[22594, 570, 5760, 152, 580, "Input",ExpressionUUID->"5b74f9f5-ec7e-4101-ae75-174d0a26be06"],
Cell[CellGroupData[{
Cell[28379, 726, 842, 15, 22, "Print",ExpressionUUID->"5d6aa923-4d09-4929-90df-00078e950c41"],
Cell[29224, 743, 1053, 18, 22, "Print",ExpressionUUID->"5e47de36-6dfd-4136-a35c-ff0b9ec21793"],
Cell[30280, 763, 1053, 18, 22, "Print",ExpressionUUID->"afa0b017-8f3e-4596-b25d-7fbb31e4ddf2"],
Cell[31336, 783, 1055, 18, 22, "Print",ExpressionUUID->"0fb489ae-c639-4532-96f2-d95f67fdea60"],
Cell[32394, 803, 1055, 18, 22, "Print",ExpressionUUID->"7aa59ebc-9284-4140-940b-b42b99cfa6a4"],
Cell[33452, 823, 1055, 18, 22, "Print",ExpressionUUID->"7f11e9b3-db09-48f3-b31f-ccd71f1419c7"],
Cell[34510, 843, 1055, 18, 22, "Print",ExpressionUUID->"ebb7df14-0544-4a38-99ac-cce8fe7a0b66"],
Cell[35568, 863, 1324, 30, 95, "Print",ExpressionUUID->"e027bd01-af85-4cc1-a1b4-1905ad332340"],
Cell[36895, 895, 1015, 21, 22, "Print",ExpressionUUID->"13c012f0-50a0-4193-a05e-0dea7216a953"],
Cell[37913, 918, 985, 20, 22, "Print",ExpressionUUID->"13c99376-66d3-4679-962d-e2972272e9a3"],
Cell[38901, 940, 1296, 29, 22, "Print",ExpressionUUID->"9566893a-db3e-4855-bccf-306a249980df"],
Cell[40200, 971, 1297, 29, 22, "Print",ExpressionUUID->"2d091c24-2015-4145-a64d-8d65a1659fa7"],
Cell[41500, 1002, 949, 18, 22, "Print",ExpressionUUID->"b4cfbbe6-22a6-47a2-859a-367b92efe7ff"],
Cell[42452, 1022, 944, 18, 22, "Print",ExpressionUUID->"bc213d75-f789-496d-aad3-9629768b6d23"],
Cell[43399, 1042, 842, 15, 22, "Print",ExpressionUUID->"ea027673-f562-4629-96d2-2b5ca58d9670"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44290, 1063, 2843, 75, 352, "Input",ExpressionUUID->"823577f2-2713-4ab7-8b47-46dd0d8bdb82"],
Cell[CellGroupData[{
Cell[47158, 1142, 382, 9, 22, "Print",ExpressionUUID->"54f1e3bf-d2cd-4842-9dc6-ccd5ba5c0496"],
Cell[47543, 1153, 417, 10, 22, "Print",ExpressionUUID->"3d4ac697-8804-4e40-a360-742f78a4c0f4"]
}, Open  ]]
}, Open  ]]
}
]
*)

